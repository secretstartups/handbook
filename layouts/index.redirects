# See docs for redirects in GitLab Pages:
#   https://docs.gitlab.com/ee/user/project/pages/redirects.html
#
# This file is automatically generated from a template:
#   layouts/index.redirects
#
# If you're moving individual files please use aliases and don't manually add redirects to this file - https://handbook.gitlab.com/handbook/editing-handbook/frontmatter/#aliases.
# If you're moving an entire directory it's OK to add a redirect entry above the final `Handbook doesn't use .html style page locations so repoint these` section rather than adding aliases for each individual file

{{ $aliases := newScratch -}}
{{ $section_aliases := newScratch -}}
{{ $root_sections := slice -}}
{{/* handle explicit aliases in frontmatter */}}
{{- range $p := .Site.Pages -}}
{{- $aliases.Add $p.RelPermalink $p.Aliases -}}
{{- end -}}
{{- range .Site.Sections -}}
{{- $root_sections = $root_sections | append .RelPermalink -}}
{{- end -}}
{{/* custom aliases for handbook sections */}}
{{- with site.GetPage "handbook" -}}
{{- range .Sections -}}
{{- if not (in $root_sections (replace .RelPermalink "/handbook" "")) -}}
{{- $section_aliases.Add (printf "%s:splat" .RelPermalink) (replace .RelPermalink "/handbook" "" 1 | printf "%s*" | slice) -}}
{{- end -}}
{{- end -}}
{{- end -}}
{{ printf "\n# Aliases Generated from Front Matter" }}
{{ printf "" }}
{{- range $permalink, $redirects := $aliases.Values -}}
{{- range $r := $redirects -}}
{{- printf "%s %s\n" $r $permalink -}}
{{- end -}}
{{- end -}}
{{ printf "\n# Root level section aliases\n" }}
{{- range $permalink, $redirects := $section_aliases.Values -}}
{{- range $r := $redirects -}}
{{- printf "%s %s\n" $r $permalink -}}
{{- end -}}
{{- end -}}
{{ printf "" }}

# Files with Underscores in their Name - remove 2024-12-01
/handbook/security/External_Security_Communications_Procedure.html /handbook/security/external-security-communications-procedure/ 301
/handbook/security/gitlab_projects_baseline_requirements.html /handbook/security/gitlab_projects_baseline_requirements/ 301
/handbook/security/gitlab_security_resource_center.html /handbook/security/gitlab_security_resource_center/ 301
/handbook/security/security-assurance/field-security/answerbase_quality_guide.html /handbook/security/security-assurance/field-security/answerbase_quality_guide/ 301
/handbook/security/security-assurance/field-security/field_security_observation_and_ofi_quality_guide.html /handbook/security/security-assurance/field-security/field_security_observation_and_ofi_quality_guide/ 301
/handbook/security/security-assurance/field-security/independent_security_assurance.html /handbook/security/security-assurance/field-security/independent_security_assurance/ 301
/handbook/security/security-assurance/governance_and_field_security_team_charter.html /handbook/security/security-assurance/governance_and_field_security_team_charter/ 301
/handbook/security/security-assurance/production_readiness_compliance_assessment.html /handbook/security/security-assurance/production-readiness-compliance-assessment/ 301
/handbook/security/security-assurance/security-risk/sox_cuec_mapping_procedure.html /handbook/security/security-assurance/security-risk/sox_cuec_mapping_procedure/ 301
/handbook/legal/privacy/us-state-privacy-disclosure/ https://about.gitlab.com/privacy/us-state-privacy-rights-and-disclosures/ 301

# Solutions Architecture Handbook Moved - remove 2025-06-01
/handbook/customer-success/solutions-architects/* /handbook/solutions-architects/:splat 301
/handbook/customer-success/solutions-architects/ /handbook/solutions-architects/ 301

# Domain level redirects
/handbook/customer-success/csm/segment/cse/webinar-calendar/ https://university.gitlab.com/pages/gitlab-user-webinars 301
/handbook/customer-success/csm/segment/scale/webinar-calendar/  https://university.gitlab.com/pages/gitlab-user-webinars 301

# Handbook doesn't use .html style page locations so repoint these
/*.html /:splat/ 301
